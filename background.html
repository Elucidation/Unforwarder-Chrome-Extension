<script>
// Script run on a google search result page, replacing all google-forwarded result links with original links in place.
// Example starting google-forwarded url :
//              http://www.google.com/url?sa=t&rct=j&q=fear%20not%20the%20valient&source=web&cd=1&ved=0CCAQFjAA&url=http%3A%2F%2Fen.wikiquote.org%2Fwiki%2FCourage&ei=QiiyTu2QGZHAtgfB762cAg&usg=AFQjCNHOaIV8vNJ1fxGxdNmYkl3v9jpumw&sig2=IbeYKkY9u-lfRGUA38gRtw
// Fixed ending url: 
//              http://en.wikiquote.org/wiki/Courage
// Author : Sameer Ansari
var i = 0;
var replaceForwards = function(tab) {  
  chrome.tabs.executeScript( null, {file: "replace_script.js"} );
  chrome.browserAction.setBadgeText( {text:String(i)} );
  i++;
};

var checkComplete = function(tab,info) {
   chrome.browserAction.setBadgeText( {text:info.status} );
   if (info.status == "complete") {
      chrome.tabs.getCurrent(replaceForwards);
   }
}

chrome.tabs.onUpdated.addListener(checkComplete);
chrome.browserAction.onClicked.addListener(replaceForwards);
</script>

